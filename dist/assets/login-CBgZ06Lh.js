import{C as d,a as c,T as u,A as m,b as p}from"./index-DmCTqCc4.js";class h extends d{static getTemplate(){return'<div class="form-component">Form Component Template</div>'}constructor(t={}){super(t),this.name=t.name||"",this.label=t.label||"",this.required=t.required||!1,this.disabled=t.disabled||!1,this.value=t.value||"",this.placeholder=t.placeholder||"",this.validationRules=t.validationRules||[],this.errorMessage=t.errorMessage||"",this.contract=t.contract||null}getValue(){return this.value}setValue(t){this.value=t,this.isRendered&&this._updateValue()}validate(){if(!this.required&&!this.value)return!0;if(this.contract)try{return this.contract.parse({[this.name]:this.value},"create"),this._clearError(),!0}catch(t){return this._showError(t.message),!1}for(const t of this.validationRules)if(!t.validate(this.value))return this._showError(t.message),!1;return this._clearError(),!0}_showError(t){this.errorMessage=t,this.host.classList.add("error")}_clearError(){this.errorMessage="",this.host.classList.remove("error")}_updateValue(){}}class f extends d{static getTemplate(){return""}constructor(t={}){if(!t.host)throw new Error("Form requires a host element");const e=typeof t.host=="string"?document.querySelector(t.host):t.host;if(!e)throw new c("Form",t.host,new Error("Form host element not found"));super({host:e}),this.formClass=t.formClass||"",this.sections=t.sections||[],this.onSubmit=t.onSubmit||null,this.formElement=null,this.components=[],this.opts=t}async _render(){try{this._generateFormStructure(),await this._renderSections(),this.onSubmit&&this.formElement.addEventListener("submit",this._handleSubmit.bind(this)),this.host.innerHTML="",this.host.appendChild(this.formElement)}catch(t){console.error("Form _render failed:",t),this._renderFallback()}}_generateFormStructure(){this.formElement=document.createElement("form"),this.formElement.className=this.formClass,this.formElement.setAttribute("novalidate","true"),this.sectionsContainer=document.createElement("div"),this.formElement.appendChild(this.sectionsContainer)}async _renderSections(){for(const t of this.sections)await this._renderSection(t)}async _renderSection(t){const e=document.createElement("div");t.opts&&this._applySectionStyles(e,t.opts),t.titles&&this._renderTitles(e,t.titles),t.components&&await this._renderComponents(e,t.components),this.sectionsContainer.appendChild(e)}_applySectionStyles(t,e){e.gap&&(t.style.gap=`${e.gap*.25}rem`),e.px&&(t.style.paddingLeft=`${e.px*.25}rem`,t.style.paddingRight=`${e.px*.25}rem`),e.py&&(t.style.paddingTop=`${e.py*.25}rem`,t.style.paddingBottom=`${e.py*.25}rem`),t.style.display="flex",t.style.flexDirection="column"}_renderTitles(t,e){e.forEach(i=>{const s=document.createElement(i.relevance===1?"h1":i.relevance===2?"h2":"h3");s.textContent=i.text,s.className=i.classes?.join(" ")||"",t.appendChild(s)})}async _renderComponents(t,e){for(const i of e)await this._renderComponent(t,i)}async _renderComponent(t,e){const i=document.createElement("div");t.appendChild(i);try{const s=new e.type({host:i,...e.opts});await s.render(),this.components.push(s)}catch(s){console.error("Failed to render component:",s),i.innerHTML='<div class="component-error">Component failed to load</div>'}}_handleSubmit(t){if(t.preventDefault(),this.onSubmit){const e=this._getFormValues();this.onSubmit(e)}}_getFormValues(){const t={};return this.formElement.querySelectorAll("input, select, textarea").forEach(i=>{i.id&&(t[i.id]=i.value)}),this.components.forEach(i=>{i.getValue&&i.opts?.id&&(t[i.opts.id]=i.getValue())}),t}getValues(){return this._getFormValues()}setValues(t){Object.keys(t).forEach(e=>{const i=this.formElement.querySelector(`#${e}`);i&&(i.value=t[e])})}reset(){this.formElement.reset()}validate(){return this.formElement.checkValidity()}destroy(){this.components.forEach(t=>{typeof t.destroy=="function"&&t.destroy()}),this.components=[],super.destroy()}}const b=["Backspace","Delete","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Tab","Home","End","Enter"],l={username:/^[A-Za-z0-9]$/,simpleText:/^[A-Za-zÁÉÍÓÚÑáéíóúñ0-9\s]$/,normalText:/^[A-Za-zÁÉÍÓÚÑáéíóúñ0-9.,\s]$/,password:/^[A-Za-z0-9#!@&]$/,number:/^\d$/,decimal:/^\d*\.?\d{0,3}$/,email:/^[A-Za-z0-9@.]$/};class o extends h{static getTemplate(){return`
<template id="tmpl-form-input">
  <div class="flex flex-col flex-1" data-input>
    <div>
      <label data-label
        class="mb-1 ml-2 text-xs font-semibold bg-gradient-to-r from-[rgb(var(--text-from))] to-[rgb(var(--text-to))] bg-clip-text text-transparent select-none">
      </label>
    </div>
    <div class="relative w-full" data-input-wrapper>
      <input type="text" data-field
        class="px-4 py-3 shadow-md rounded-lg w-full bg-gradient-to-r from-[rgb(var(--card-from))] to-[rgb(var(--card-to))] placeholder-[rgb(var(--placeholder-from))] focus:outline-none transition-all duration-300 placeholder:italic text-[rgb(var(--text-from))]">
      <button type="button" data-password-btn class="absolute inset-y-0 flex items-center right-3">
        <svg data-eye-open xmlns="http://www.w3.org/2000/svg"
          class="text-[rgb(var(--placeholder-from))] hover:text-[rgb(var(--text-from))] w-5 h-5 stroke-current fill-none cursor-pointer transition-colors duration-300"
          viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0" />
          <circle cx="12" cy="12" r="3" />
        </svg>
        <svg data-eye-closed xmlns="http://www.w3.org/2000/svg"
          class="hidden text-[rgb(var(--placeholder-from))] hover:text-[rgb(var(--text-from))] w-5 h-5 stroke-current fill-none cursor-pointer transition-colors duration-300"
          viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49" />
          <path d="M14.084 14.158a3 3 0 0 1-4.242-4.242" />
          <path d="M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143" />
          <path d="m2 2 20 20" />
        </svg>
      </button>
    </div>
    <textarea data-textarea
      class="px-4 py-3 shadow-md rounded-lg w-full bg-gradient-to-r from-[rgb(var(--card-from))] to-[rgb(var(--card-to))] placeholder-[rgb(var(--placeholder-from))] focus:outline-none transition-all duration-300 placeholder:italic text-[rgb(var(--text-from))] hidden"></textarea>
  </div>
</template>
    `}constructor(t={}){if(!t.host)throw new Error("FormInput requires a host element");const e=typeof t.host=="string"?document.querySelector(t.host):t.host;if(!e)throw new Error("FormInput host element not found");super({host:e,name:t.name||t.id||"custom-input",label:t.label||null}),this.type=t.type||"text",this.placeholder=t.placeholder||"",this.onChange=t.onChange||(()=>{}),this.validationMethod=t.validationMethod||null,this.numberInputOpts=t.numberInputOpts||{},this.rows=t.rows||3,this.id=t.id||null,this._validateNumberOpts(),this._render()}_validateNumberOpts(){if(this.type!=="number")return;const{min:t,max:e,step:i,allowsDecimals:s}=this.numberInputOpts;s===!1&&[t,e,i].forEach(r=>{if(r!==void 0&&r%1!==0)throw new Error("[FormInput]",`NumberInput property ${r} must be integer when allowsDecimals is false`)})}async _render(){try{const t=document.createElement("template");t.innerHTML=o.getTemplate();const e=t.content.querySelector("#tmpl-form-input");this.root=e.content.firstElementChild.cloneNode(!0),this.id&&(this.root.id=this.id),this.labelEl=this.root.querySelector("[data-label]"),this.field=this.root.querySelector("[data-field]"),this.textarea=this.root.querySelector("[data-textarea]"),this.pwBtn=this.root.querySelector("[data-password-btn]"),this.eyeOpen=this.root.querySelector("[data-eye-open]"),this.eyeClosed=this.root.querySelector("[data-eye-closed]"),this.label?this.labelEl&&(this.labelEl.textContent=this.label):this.labelEl&&this.labelEl.classList.add("hidden"),this.type==="textarea"?this._setupTextarea():this._setupInputField(),this._attachEvents(),this.host.innerHTML="",this.host.appendChild(this.root)}catch(t){console.error("FormInput render failed:",t),this.host.innerHTML=`
        <div class="form-input" ${this.id?`id="${this.id}"`:""}>
          ${this.label?`<label>${this.label}</label>`:""}
          <input type="${this.type}" name="${this.name}" placeholder="${this.placeholder}" ${this.id?`id="${this.id}"`:""} />
        </div>
      `}}_setupTextarea(){this.field&&this.field.classList.add("hidden"),this.pwBtn&&this.pwBtn.classList.add("hidden"),this.textarea&&(this.textarea.classList.remove("hidden"),this.textarea.name=this.name,this.textarea.placeholder=this.placeholder,this.textarea.rows=this.rows,this.id&&(this.textarea.id=this.id))}_setupInputField(){if(this.field&&(this.field.classList.remove("hidden"),this.field.name=this.name,this.field.placeholder=this.placeholder,this.id&&(this.field.id=this.id),this.textarea&&this.textarea.classList.add("hidden"),this.type==="password"?(this.field.type="password",this.eyeOpen&&this.eyeOpen.classList.add("hidden"),this.eyeClosed&&this.eyeClosed.classList.remove("hidden")):(this.field.type=this.type==="number"?"number":this.type,this.pwBtn&&this.pwBtn.classList.add("hidden"))),this.type==="number"&&this.field){const{min:t,max:e,step:i}=this.numberInputOpts;t!==void 0&&(this.field.min=t),e!==void 0&&(this.field.max=e),i!==void 0&&(this.field.step=i)}}_attachEvents(){const t=this.type==="textarea"?this.textarea:this.field;t&&(this.type==="password"&&this.pwBtn&&this.pwBtn.addEventListener("click",()=>{const e=t.type==="password";t.type=e?"text":"password",this.eyeOpen&&this.eyeOpen.classList.toggle("hidden",!e),this.eyeClosed&&this.eyeClosed.classList.toggle("hidden",e)}),this.validationMethod&&l[this.validationMethod]&&(t.addEventListener("keydown",e=>{b.includes(e.key)||e.ctrlKey||e.metaKey||l[this.validationMethod].test(e.key)||e.preventDefault()}),t.addEventListener("paste",e=>e.preventDefault())),t.addEventListener("input",()=>{this.onChange(t.value)}))}getHTML(){return this.root}getValue(){return(this.type==="textarea"?this.textarea:this.field)?.value??""}setValue(t){const e=this.type==="textarea"?this.textarea:this.field;e&&(e.value=t)}validate(t=this.validationMethod){const e=this.getValue();return t?t==="email"?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):t==="password"?e.length>=8&&e.length<=256:!0:!0}reset(){const t=this.type==="textarea"?this.textarea:this.field;t&&(t.value=""),this.onChange("")}}class a extends h{static getTemplate(){return`
<template id="tmpl-submit-input">
  <button id="submit-input" type="submit"
    class="p-6 w-full bg-gradient-to-tr from-[rgb(var(--button-from))] to-[rgb(var(--button-to))] text-white text-shadow rounded-xl grid grid-cols-[auto_1fr] items-center shadow-md hover:brightness-120 hover:scale-[1.015] transition-all duration-300 cursor-pointer select-none">
    <span id="submit-icon" class="inline-flex items-center justify-center">
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none" class="svg-shadow"
        xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd"
          d="M20 6.66668C12.6362 6.66668 6.66671 12.6362 6.66671 20C6.66671 27.3638 12.6362 33.3333 20 33.3333C27.3638 33.3333 33.3334 27.3638 33.3334 20C33.3334 12.6362 27.3638 6.66668 20 6.66668ZM3.33337 20C3.33337 10.7953 10.7953 3.33334 20 3.33334C29.2048 3.33334 36.6667 10.7953 36.6667 20C36.6667 29.2048 29.2048 36.6667 20 36.6667C10.7953 36.6667 3.33337 29.2048 3.33337 20ZM18.8215 16.1785C18.1707 15.5276 18.1707 14.4724 18.8215 13.8215C19.4724 13.1706 20.5277 13.1706 21.1786 13.8215L26.1786 18.8215C26.8294 19.4724 26.8294 20.5276 26.1786 21.1785L21.1786 26.1785C20.5277 26.8294 19.4724 26.8294 18.8215 26.1785C18.1707 25.5276 18.1707 24.4724 18.8215 23.8215L20.9764 21.6667H15C14.0796 21.6667 13.3334 20.9205 13.3334 20C13.3334 19.0795 14.0796 18.3333 15 18.3333H20.9764L18.8215 16.1785Z"
          fill="white" />
      </svg>
    </span>
    <span id="submit-text" class="block w-full font-medium text-center">Enviar</span>
  </button>
</template>
    `}constructor(t={}){if(!t.host)throw new Error("SubmitInput requires a host element");super({host:typeof t.host=="string"?document.querySelector(t.host):t.host,name:t.name||t.id||"submit-input",label:t.label||null,required:!1,disabled:!!t.disabled}),this.id=t.id||null,this.text=t.text??"Enviar",this.icon=t.icon??"",this.fullWidth=t.fullWidth!==!1,this.removeIcon=!!t.removeIcon,this.additionalClasses=t.additionalClasses||"",this.onClick=typeof t.onClick=="function"?t.onClick:null,this._render()}async _render(){try{const t=document.createElement("template");t.innerHTML=a.getTemplate();const e=t.content.querySelector("#tmpl-submit-input");this.root=e.content.firstElementChild.cloneNode(!0),this.id&&(this.root.id=this.id),this.fullWidth&&this.root.classList.add("w-full"),this.additionalClasses&&this.additionalClasses.split(/\s+/).filter(Boolean).forEach(r=>this.root.classList.add(r));const i=this.root.querySelector("#submit-text");i&&(i.textContent=this.text);const s=this.root.querySelector("#submit-icon");s&&(this.removeIcon?(s.remove(),this._makeNoIconLayout()):this.icon&&(s.innerHTML=this.icon)),this.onClick&&this.root.addEventListener("click",this.onClick),this.host.innerHTML="",this.host.appendChild(this.root),this.isRendered=!0}catch(t){console.error("[SubmitInput] render failed:",t),this.host.innerHTML=`<button type="submit" class="px-4 py-3 rounded bg-[rgb(var(--text-from))] text-white">${this.text}</button>`,this.root=this.host.querySelector("button"),this.isRendered=!0}}_makeNoIconLayout(){this.root.classList.remove("grid","grid-cols-[auto_1fr]","items-center"),this.root.classList.add("grid","grid-cols-1","place-items-center")}getValue(){return null}setValue(t){}validate(){return!0}setText(t){const e=this.root?.querySelector("#submit-text");e&&(e.textContent=t)}setIcon(t){const e=this.root?.querySelector("#submit-icon");e&&t&&(e.innerHTML=t,this.root.classList.remove("grid-cols-1","place-items-center"),this.root.classList.add("grid","grid-cols-[auto_1fr]","items-center"))}}class y{constructor(){this.initialized=!1}static getTemplate(){return""}async init(){throw new Error("init() method must be implemented by subclass")}async render(t="#main-view"){try{const e=this.constructor.getTemplate(),i=typeof t=="string"?document.querySelector(t):t;if(!i)throw new Error(`Container not found: ${t}`);i.innerHTML=e,await this.init(),this.initialized=!0}catch(e){throw console.error("Interface render failed:",e),e}}destroy(){this.initialized=!1}}class v extends y{static getTemplate(){return`
            <main class="flex items-center justify-center min-h-screen mb-1 overflow-y-auto scrollbar-width-none">
                <div id="login-form-host" class="flex justify-center w-full md:justify-start md:ml-60">
                </div>
            </main>
        `}async init(){await this._setupToast(),await this._setupForm()}async _setupToast(){this.toast=new u,await this.toast.init()}async _setupForm(){this.form=new f({host:"#login-form-host",formClass:"gap-16 px-6 mx-auto md:mx-0 md:px-0 z-50 w-full",sections:[{opts:{gap:2},titles:[{text:"Inicio de sesión",relevance:1,classes:["text-3xl","font-bold","text-left","bg-gradient-to-r","from-[rgb(var(--button-from))]","to-[rgb(var(--button-to))]","bg-clip-text","text-transparent"]},{text:"¡Bienvenido!",relevance:3,classes:["text-lg","font-semibold","text-left","bg-gradient-to-r","from-[rgb(var(--button-from))]","to-[rgb(var(--button-to))]","bg-clip-text","text-transparent"]}]},{opts:{gap:6},components:[{type:o,opts:{id:"email-input",type:"text",placeholder:"Correo electrónico"},validation:["email"]},{type:o,opts:{id:"password-input",type:"password",placeholder:"Contraseña"},validation:["password"]}]},{opts:{gap:4,px:10},components:[{type:a,opts:{id:"submit-button",text:"Iniciar sesión"}}]}],onSubmit:async t=>{try{await m.login((t["email-input"]||"").trim(),(t["password-input"]||"").trim()),console.info("[Login] Login API call completed"),await p.authLogin()?window.location.hash="#main":this.toast.show("Sesión no válida")}catch(e){console.error(e),this.toast.show("Error al iniciar sesión")}}}),await this.form.render()}}export{v as LoginInterface};
